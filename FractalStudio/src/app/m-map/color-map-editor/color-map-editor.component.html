<div>
  <h3 style="text-align:center; margin:0px 0px 8px 0px">Color Map</h3>

  <form [formGroup]="colorMapForm" (ngSubmit)="onSubmit()">

    <div class="btnGroup">
      <button type="submit" [disabled]="!colorMapForm.valid"> Apply</button>
      <button type="button" (click)="onSaveColorMap()">Save</button>
    </div>

    <div class="btnGroup">
      <button type="button" (click)="onUseHistogram()" style="width:150px">Load from Histogram</button>
      <label style="margin-left:10px">With: <input type="text" formControlName="sectionCnt" size="1"></label>
      <label style="margin-left:5px">sections</label>
    </div>

    <div class="btnGroup">
      <input type="file" #fileSelector value="Import" style="margin-top:8px" />
      <button type="button" (click)="onLoadColorMap()">Load</button>
    </div>

    <a #download href="#" hidden="hidden">Download</a>

    <div formArrayName="cEntries" style="margin-left:10px">
      <div *ngFor="let colEntry of colorEntryForms; let i=index">

        <div [formGroupName]="i" style="width:150px; border: 1px solid lightgray; padding: 3px 3px 3px 18px; margin-bottom:2px;">
          <label>CutOff: <input type="text" formControlName="cutOff" size="5"></label>
          <br />
          <!-- Clickable Color Block -->
          <div style="position:relative; width:55px; height:25px; margin:5px;">

            <!--<div [ngStyle]="getColorBlockStyle(i)" (click)="onEditColor(i)"></div>-->
            <!--<div [ngStyle]="{'background-color': colorMapForm.controls.cEntries.controls[i].controls.rgbaColor.value || 'white'}" (click)="onEditColor(i)"></div>-->
            <div [ngStyle]="{'position': 'absolute',
                                        'width': '100%',
                                        'height': '100%',
                                        'background-color': colEntry.controls.rgbaColor.value || 'white',
                                        'border': '1px solid black'
                 }"
                 (click)="onEditColor(i)"></div>
          </div>


          <!--'background-color': colorMapForm.controls.cEntries.controls[i].controls.rgbaColor.value || 'white',-->
          <!--<div *ngIf="colorMapForm.controls.cEntries.controls[i].controls.showEditor.enabled">
          <label>Red: <input type="text" formControlName="r" size="5" (blur)="onCEntryEditorBlur(i)"></label><br />
          <label>Green: <input type="text" formControlName="g" size="5"></label><br />
          <label>Blue: <input type="text" formControlName="b" size="5"></label>
        </div>-->
          <!--colorMapForm.controls.cEntries.controls[i].controls.rgbacolor.value-->

          <div *ngIf="colorMapForm.controls.cEntries.controls[i].controls.showEditor.enabled">
            <app-color-picker [item]="i" [rgbaColor]="colorMapForm.controls.cEntries.controls[i].controls.rgbaColor.value" (colorUpdated)="setRgbaColor($event)"></app-color-picker>
            <!--<span class="text">{{colorMapForm.controls.cEntries.controls[i].controls.rgbaColor.value}}</span>-->
          </div>

        </div>

      </div>
    </div>
  </form>



</div>
